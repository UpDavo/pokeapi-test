<div class="space-y-6 p-4">
  <!-- Header -->
  <div class="md:flex grid items-center justify-between">
    <div>
      <h1 class="text-2xl font-bold text-gray-800">{{ 'pokedex.title' | translate }}</h1>
      <p class="text-gray-600 mt-1">{{ 'pokedex.description' | translate }}</p>
    </div>

    <!-- Bot√≥n refrescar -->
    <p-button
      [label]="'pokedex.add_new' | translate"
      icon="pi pi-refresh"
      [loading]="isLoading"
      (click)="refreshPokedex()"
      styleClass="md:mt-0 mt-4"
    ></p-button>
  </div>

  <!-- Filtros -->
  <app-pokemon-filter
    [totalCount]="totalCount"
    [filteredCount]="filteredCount"
    [isLoading]="isLoading || isFiltering"
    (filterChange)="onFilterChange($event)"
    (clearFilters)="onClearFilters()"
  ></app-pokemon-filter>

  <!-- Barra de ordenamiento -->
  @if (!isLoading && filteredCount > 0) {
  <p-card>
    <ng-template pTemplate="content">
      <div class="flex items-center justify-between flex-wrap gap-4">
        <div class="flex items-center gap-4">
          <span class="text-sm font-medium text-gray-700">{{ 'pokedex.sortBy' | translate }}:</span>

          <select
            class="p-2 border rounded-md"
            [(ngModel)]="sortBy"
            (change)="onSortChange(sortBy, sortOrder)"
          >
            <option value="capturedAt">{{ 'pokedex.sort.captureDate' | translate }}</option>
            <option value="name">{{ 'pokedex.sort.name' | translate }}</option>
            <option value="level">{{ 'pokedex.sort.level' | translate }}</option>
            <option value="atk">{{ 'pokedex.sort.attack' | translate }}</option>
            <option value="def">{{ 'pokedex.sort.defense' | translate }}</option>
            <option value="spd">{{ 'pokedex.sort.speed' | translate }}</option>
          </select>

          <p-button
            [label]="
              sortOrder === 'asc'
                ? '‚Üë ' + ('pokedex.sort.ascending' | translate)
                : '‚Üì ' + ('pokedex.sort.descending' | translate)
            "
            [outlined]="true"
            size="small"
            (click)="onSortChange(sortBy, sortOrder === 'asc' ? 'desc' : 'asc')"
          ></p-button>
        </div>

        <!-- Info de paginaci√≥n -->
        @if (totalPages > 1) {
        <div class="text-sm text-gray-600">
          {{ paginationInfo }}
        </div>
        }
      </div>
    </ng-template>
  </p-card>
  }

  <!-- Estados de carga y vac√≠o -->
  @if (isLoading) {
  <!-- Loading state -->
  <p-card>
    <ng-template pTemplate="content">
      <div class="flex items-center justify-center py-8">
        <div class="text-center space-y-4">
          <p-progressSpinner
            styleClass="w-16 h-16"
            strokeWidth="4"
            fill="transparent"
            animationDuration="1s"
          >
          </p-progressSpinner>
          <div>
            <h3 class="font-semibold text-gray-900">{{ 'pokedex.loading.title' | translate }}</h3>
            <p class="text-gray-500 text-sm">{{ 'pokedex.loading.description' | translate }}</p>
          </div>
        </div>
      </div>
    </ng-template>
  </p-card>
  } @else if (hasNoPokemons) {
  <!-- No Pok√©mon capturados -->
  <p-card>
    <ng-template pTemplate="content">
      <div class="text-center space-y-4 py-8">
        <div>
          <h3 class="font-semibold text-gray-900">{{ 'pokedex.empty.title' | translate }}</h3>
          <p class="text-gray-500 text-sm">{{ 'pokedex.empty.description' | translate }}</p>
        </div>
      </div>
    </ng-template>
  </p-card>
  } @else if (hasNoResults) {
  <!-- No resultados con filtros -->
  <p-card>
    <ng-template pTemplate="content">
      <div class="text-center space-y-4 py-8">
        <div class="w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center">
          <span class="text-2xl">üîç</span>
        </div>
        <div>
          <h3 class="font-semibold text-gray-900">{{ 'pokedex.noResults.title' | translate }}</h3>
          <p class="text-gray-500 text-sm">{{ 'pokedex.noResults.description' | translate }}</p>
          @if (hasActiveFilters) {
          <p-button
            [label]="'pokedex.noResults.clearFilters' | translate"
            [outlined]="true"
            size="small"
            (click)="onClearFilters()"
            styleClass="mt-2"
          ></p-button>
          }
        </div>
      </div>
    </ng-template>
  </p-card>
  } @else {
  <!-- Grid de Pok√©mon -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
    @for (pokemon of displayedPokemon; track trackByPokemonId($index, pokemon)) {
    <app-pokemon-card [pokemon]="pokemon"></app-pokemon-card>
    } @empty {
    <div class="col-span-full text-center py-8 text-gray-500">
      {{ 'pokedex.noResults.title' | translate }}
    </div>
    }
  </div>

  <!-- Paginaci√≥n -->
  @if (totalPages > 1) {
  <div class="flex justify-center mt-6">
    <p-paginator
      [first]="(currentPage - 1) * pageSize"
      [rows]="pageSize"
      [totalRecords]="filteredCount"
      [rowsPerPageOptions]="[12, 24, 48]"
      (onPageChange)="onPaginatorChange($event)"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="{{ 'pokedex.pagination.showing' | translate }} {first} - {last} {{
        'pokedex.pagination.of' | translate
      }} {totalRecords}"
    ></p-paginator>
  </div>
  } }
</div>

<!-- Modal de captura -->
<app-capture-modal
  [(visible)]="showCaptureModal"
  (pokemonCaptured)="onPokemonCaptured($event)"
></app-capture-modal>
